<% reviews.each do |review| %>
  <div class="flex border border-gray-900 shadow-md mb-3 rounded-md p-5 ml-2 h-32">
    <div class="h-full my-auto">
      <%= link_to user_path(review.user) do %>
        <%= image_tag review.user.get_profile_image(50,50), class: 'rounded-full hover:opacity-75 bg-white' %>
      <% end %>
      <p class="font-bold mt-2 whitespace-nowrap text-center text-gray-400"><%= review.user.name %></p>
    </div>
    <div class="mt-3 ml-auto">
      <span class="flex mb-20" id="star2<%= review.id %>"></span>
    </div>
    <p class="mt-3 ml-2 text-gray-400"><%= review.rate %></p>
    <p class="w-96 text-sm text-gray-400 line-clamp-4 mx-auto mt-3 hover:opacity-75">
       <a class="js-modal-open" data-target="#modal_<%= review.id %>" href=""><%= review.comment %></a>
    </p>
    <% if (user_signed_in? && current_user.admin) || current_user == review.user %>
      <span class="ml-auto"><%= link_to "編集",edit_item_review_path(review), class: 'text-gray-400 hover:opacity-75' %></span>
    <% end %>
    <% if review.good_by?(current_user) && user_signed_in? %>
      <p class="mt-auto">
        <%= link_to item_review_goods_path(review,review.item), method: :delete, class: 'text-ratyyellow' do %>
          <i class="fa-solid fa-thumbs-up mx-3"></i><%= review.goods.count %>
        <% end %>
      </p>
    <% else %>
      <p class="mt-auto">
        <%= link_to item_review_goods_path(review,review.item), method: :post, class: 'text-gray-400 hover:text-ratyyellow ' do %>
          <i class="fa-regular fa-thumbs-up mx-3"></i><%= review.goods.count %>
        <% end %>
      </p>
    <% end %>
  </div>

  <%= render 'modal', review: review %>

  <script>
  $('#star2<%= review.id %>').empty();
  $('#star2<%= review.id %>').raty({
    size      : 36,
    starOff   : '<%= asset_path('star-off.png') %>',
    starHalf: '<%= asset_path('star-half.png') %>',
    starOn    : '<%= asset_path('star-on.png') %>',
    half      : false,
    readOnly: true,
    score: <%= review.rate %>,
  });
  $(function(){
 $('.js-modal-open').on('click',function(){
   $($(this).data('target')).fadeIn();
   return false;
 });
 $('.js-modal-close').on('click',function(){
   $('.js-modal').fadeOut();
   return false;
 });
});
  </script>
<% end %>
