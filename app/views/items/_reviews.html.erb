<% reviews.each do |review| %>
  <div class="flex border border-gray-900 shadow-md mb-3 rounded-md p-5 h-32 lg:w-3/5 mx-auto">
    <div class="h-full my-auto">
      <%= link_to user_path(review.user) do %>
        <%= image_tag review.user.get_profile_image(700,700), class: 'h-2/3 rounded-full hover:opacity-75 bg-white' %>
      <% end %>
      <p class="font-bold mt-2 whitespace-nowrap text-center text-gray-400"><%= review.user.name %></p>
    </div>
    <div class="mt-3 ml-auto">
      <span class="flex pl-5" id="star2<%= review.id %>"></span>
    </div>
    <p class="mt-3 ml-2 text-gray-400 px-3"><%= review.rate %></p>
    <p class="w-96 text-sm text-gray-400 line-clamp-4 mx-auto mt-3 hover:opacity-75">
       <a class="js-modal-open px-3" data-target="#modal_<%= review.id %>" href=""><%= review.comment %></a>
    </p>
    <div class="relative h-full w-20">
      <% if current_user.admin || current_user == review.user %>
        <div class="absolute top-0 right-0">
          <%= link_to edit_item_review_path(review.item.id, review), class: 'text-gray-400' do %>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hover:opacity-75" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
        <% end %>
        </div>
      <% end %>
      <div id="good_btn<%= review.id %>" class="absolute bottom-0 right-2">
        <%= render '/items/good_btn', review: review %>
      </div>
    </div>
  </div>

  <div class="w-full"><%= render '/items/modal', review: review %></div>

  <script>
  $('#star2<%= review.id %>').empty();
  $('#star2<%= review.id %>').raty({
    size      : 36,
    starOff   : '<%= asset_path('star-off.png') %>',
    starHalf: '<%= asset_path('star-half.png') %>',
    starOn    : '<%= asset_path('star-on.png') %>',
    half      : false,
    readOnly: true,
    score: <%= review.rate %>,
  });
  $(function(){
   $('.js-modal-open').on('click',function(){
     $($(this).data('target')).fadeIn();
     return false;
   });
   $('.js-modal-close').on('click',function(){
     $('.js-modal').fadeOut();
     return false;
   });
  });
  </script>
<% end %>
